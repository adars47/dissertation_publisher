(this.webpackJsonppublisher=this.webpackJsonppublisher||[]).push([[0],{329:function(e,t,n){},330:function(e,t,n){},343:function(e,t){},346:function(e,t){},371:function(e,t){},372:function(e,t){},395:function(e,t){},397:function(e,t){},412:function(e,t){},414:function(e,t){},423:function(e,t){},425:function(e,t){},453:function(e,t){},455:function(e,t){},459:function(e,t){},461:function(e,t){},472:function(e,t){},557:function(e,t){},583:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),c=n(287),r=n.n(c),l=(n(329),n(330),n(663)),s=n(661),o=n(648),u=n(655),d=n(662),b=n(291),j=n.n(b),p=n(666),m=n(660),h=n(299),x=n(659),f=n(657),O=n(3);const g=Object(h.a)();function v(e){const[t,n]=Object(i.useState)(null),a=e.credentials,c=e.setCredentials;return Object(O.jsxs)(x.a,{theme:g,children:[t,Object(O.jsxs)(m.a,{component:"main",maxWidth:"xs",children:[Object(O.jsx)(o.a,{}),Object(O.jsxs)(d.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(O.jsx)(l.a,{sx:{m:1,bgcolor:"secondary.main"},children:Object(O.jsx)(j.a,{})}),Object(O.jsx)(p.a,{component:"h1",variant:"h5",children:"Decentralized Health Vault"}),Object(O.jsx)(p.a,{component:"h1",variant:"h5",children:"Publisher's portal"}),Object(O.jsxs)(d.a,{component:"form",onSubmit:e=>{e.preventDefault();const t=new FormData(e.currentTarget);let i={publicKey:t.get("publicKey").trim(),privateKey:t.get("privateKey").trim(),accountNumber:t.get("accountNumber").trim()};!1===a||""==i.privateKey||""==i.publicKey?(n(Object(O.jsx)(f.a,{severity:"error",children:"You must insert a valid private and public key!"})),setTimeout((function(){n(null)}),1e4)):(localStorage.setItem("credentials",JSON.stringify(i)),c(i))},noValidate:!0,sx:{mt:1},children:[Object(O.jsx)(u.a,{margin:"normal",required:!0,fullWidth:!0,id:"publicKey",label:"Public Key",name:"publicKey",autoFocus:!0}),Object(O.jsx)(u.a,{margin:"normal",required:!0,fullWidth:!0,name:"privateKey",label:"Private Key",type:"password",id:"privateKey"}),Object(O.jsx)(u.a,{margin:"normal",required:!0,fullWidth:!0,name:"accountNumber",label:"Account Number",id:"accountNumber"}),Object(O.jsx)(s.a,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Sign In"})]})]})]})]})}var y=n(667),P=n(668);var K=function(e){return Object(O.jsx)(d.a,{sx:{flexGrow:1},children:Object(O.jsx)(y.a,{position:"static",children:Object(O.jsxs)(P.a,{variant:"dense",children:[Object(O.jsx)(p.a,{variant:"h6",color:"inherit",component:"div",children:"Health Vault Publishers Portal"}),Object(O.jsx)(s.a,{variant:"contained",sx:{marginLeft:"auto"},onClick:function(){localStorage.clear(),e.setCredentials(null)},children:"Logout"})]})})})};var S=function(e){return Object(O.jsx)(m.a,{component:"main",maxWidth:"xs",children:Object(O.jsxs)(d.a,{component:"form",onSubmit:t=>{t.preventDefault();const n=new FormData(t.currentTarget);let i={publicKey:n.get("publicKey").trim(),accountNumber:n.get("accountNumber").trim()};console.log(i),localStorage.setItem("patient",i),e.setPatient(i)},sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(O.jsx)(p.a,{variant:"h6",color:"inherit",component:"div",children:"Please input patient's public key"}),Object(O.jsx)(u.a,{id:"publicKey",name:"publicKey",label:"Patient Public Key",sx:{padding:1}}),Object(O.jsx)(u.a,{id:"accountNumber",name:"accountNumber",label:"Patient Account Number",sx:{padding:1}}),Object(O.jsx)(s.a,{variant:"contained",type:"submit",children:"Start Process"})]})})},N=n(664),F=n(656),C=n(162),k=(n(338),n(292)),w=n.n(k);const _=n(585),T=n(556);Object(C.registerPlugin)(w.a);var D=function(e){const[t,n]=Object(i.useState)({}),[a,c]=Object(i.useState)({});return Object(O.jsxs)("div",{children:[Object(O.jsx)("h1",{children:"Upload Files"}),Object(O.jsx)(s.a,{variant:"contained",onClick:()=>{e.setPatient(void 0),n([]),c([])},children:"Restart Process"}),Object(O.jsxs)(N.a,{container:!0,xs:12,children:[Object(O.jsxs)(N.a,{item:!0,xs:6,children:[Object(O.jsx)("h1",{children:"Personal Files"}),Object(O.jsx)("div",{style:{margin:50},children:Object(O.jsx)(C.FilePond,{allowMultiple:!0,onupdatefiles:e=>{n({files:e.map((e=>e))})}})})]}),Object(O.jsxs)(N.a,{item:!0,xs:6,children:[Object(O.jsx)("h1",{children:"Healthcare Files"}),Object(O.jsx)("div",{style:{margin:50},children:Object(O.jsx)(C.FilePond,{allowMultiple:!0,allowFileEncode:!0,onupdatefiles:e=>{c({files:e.map((e=>e))})}})})]})]}),Object(O.jsx)(s.a,{variant:"contained",sx:{marginTop:2},onClick:async()=>{const i=new FormData;let r=0,l=function(){for(var e=16,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n="",i=0,a=t.length;i<e;++i)n+=t.charAt(Math.floor(Math.random()*a));return n}();for(let e in a.files){r++;let t=a.files[e];i.append("medical_"+t.name,t.file,t.name)}for(let e in t.files){r++;let n=t.files[e],a=T.AES.encrypt(n.getFileEncodeBase64String(),l).toString(),c=new Blob([a],{type:n.type});n=n.file,i.append("personal_"+n.name,c,n.name)}if(0==r)return void alert("No files selected");i.append("patient_pub_k",e.patient.publicKey),i.append("doctor_account",e.patient.accountNumber);let s=JSON.parse(localStorage.getItem("credentials"));i.append("doctor_pub_k",s.publicKey),i.append("patient_account",s.accountNumber),i.append("doctor_pri_k",s.privateKey);let o=await _.encryptWithPublicKey(e.patient.publicKey,l);const u=_.cipher.stringify(o);i.append("signed_encryption_key",u),F.a.post("http://backend.local/submit",i).then((t=>{200===t.status?(alert("Transaction Concluded: Transaction id "+t.data),e.setPatient(void 0),n([]),c([])):alert("Failed to upload")}))},children:"Upload"})]})};var I=function(e){const[t,n]=Object(i.useState)(void 0),a=e.setCredentials;return Object(O.jsxs)("div",{children:[Object(O.jsx)(K,{setCredentials:a}),void 0===t?Object(O.jsx)(S,{setPatient:n}):Object(O.jsx)(D,{setPatient:n,patient:t})]})};var W=function(){const[e,t]=Object(i.useState)(localStorage.getItem("credentials"));return e?Object(O.jsx)("div",{className:"App",children:Object(O.jsx)(I,{setCredentials:t})}):Object(O.jsx)("div",{className:"App",children:Object(O.jsx)(v,{credentials:e,setCredentials:t})})};var A=e=>{e&&e instanceof Function&&n.e(3).then(n.bind(null,670)).then((t=>{let{getCLS:n,getFID:i,getFCP:a,getLCP:c,getTTFB:r}=t;n(e),i(e),a(e),c(e),r(e)}))};r.a.createRoot(document.getElementById("root")).render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(W,{})})),A()}},[[583,1,2]]]);
//# sourceMappingURL=main.e8a9e4e5.chunk.js.map